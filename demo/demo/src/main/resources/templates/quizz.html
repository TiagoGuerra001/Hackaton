<!DOCTYPE html>
<html layout:decorate="~{shared/layout}" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
  <meta charset="UTF-8" />
  <title>Quiz Page</title>
</head>

<body>
  <div layout:fragment="content">

    <script>

      function onChangeRadioValue(elem) {
        const questionId = elem.name;
        $('#' + questionId).CardWidget('collapse')
        //FIXME: This can go wrong so badly...
        const nextQuestionId = "answer" + (parseInt(questionId.replace("answer", "")) + 1);
        $('#' + nextQuestionId).CardWidget('expand')
      }

    </script>

    <!-- form -->
    <form th:action="'/bodypart/' + ${mainPart.id} + '/quizzes/' + ${bodyPart.id}+ '/submit-quiz'" method="post"
      class="d-flex flex-column justify-content-center p-4">

      <div th:each="question, questionIndex : ${questions}">
        <div th:id="answer + ${questionIndex.index}"
          th:class="(${questionIndex.index == 0}) ? 'card card-light' : 'card card-light collapsed-card'">
          <div class="card-header">
            <h3 class="card-title" th:text="${question.text}"></h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="maximize">
                <i class="fas fa-expand"></i>
              </button>
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
          <div class="card-body">

            <input type="hidden" th:name="questionId + ${questionIndex.index}" th:value="${question.id}" />

            <div class="form-group" th:each="answer, answerIndex : ${questionsStrings[__${questionIndex.index}__]}">
              <label class="d-flex gap-2">
                <input type="radio" th:name="answer + ${questionIndex.index}" th:value="${answer}"
                  th:id="'answer_' + ${questionIndex.index} + '_' + ${answerIndex.index}"
                  th:onchange="onChangeRadioValue(this)">
                <span th:text="${answer}"></span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- <div class="d-flex flex-column gap-2 ">
        <div class="card card-light collapsed-card" th:each="question, questionIndex : ${questions}">
          <div class="card-header">
            <h3 class="card-title"></h3>
            <div class=" card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="maximize">
                <i class="fas fa-expand"></i>
              </button>
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>
          <div class="card-body d-flex flex-column gap-2">

            <h4 th:text="${question.text}"></h4>

            <div class="form-group" th:each="answer, answerIndex : ${questionsStrings[__${questionIndex.index}__]}">
              <label class="d-flex gap-2">
                <input type="radio" th:name="${questionIndex.index}" th:value="${answer}"
                  th:id="'answer_' + ${questionIndex.index} + '_' + ${answerIndex.index}">
                <span th:text="${answer}"></span>
              </label>
            </div>
          </div>
        </div>
      </div> -->






      <!-- <div th:each="question, questionIndex : ${questions}">
            <div class="card-body">
              <h3 th:text="${question.text}"></h3>
              <div class="row">

                
                  <div th:each="questionString, stringIndex : ${questionsStrings[__${questionIndex.index}__]}">
                      <div class="col-md-4">
                          <div class="form-group">
                              <input type="radio" path="answers" th:id="'choice' + ${questionIndex.index} + '_' + ${stringIndex.index}" th:name="${questionIndex.index}" th:value="${questionString}" />
                              <label th:text="${questionString}"></label>
                          </div>
                      </div>
                  </div>
              </div>
            </div>        
          </div>   -->

      <!-- Add submit button -->
      <button type="submit" class="btn btn-lg btn-success">Submit</button>
    </form>


  </div>
</body>



</html>